---
sidebar_position: 1
---

# 整体概述

## API使用说明

### 接入流程

- `管理后台` => `个人信息` 查看当前登录账号安全秘钥。
- 请求 API 时，头部新增 Header(Token:安全秘钥)

### 数据协议
- 客户端与服务端使用 HTTP 协议通信
- 所有的请求与响应格式固定为 JSON, 即 Content-Type: application/json。

### 通用格式

客户端调用服务端和服务端调用客户端返回，都统一如下格式：

```json
{
  "data": {
  },
  "status": 200,
  "code": 0,
  "message": "",
  "serverTime": 1708948128288
}
```

- `data`: 具体业务数据
- `status`: 非 200 请求失败
- `code`: 默认为0
- `message`: 错误信息
- `serverTime`：当前毫秒时间

## 集群通信

- 客户端启动时，调用上线接口，初始化客户端。
- 客户端启动成功，正常运行过程中，间隔(3-5s)上报客户端状态(心跳)。
- 客户端下线时，调用下线接口，主动下线客户端。

## 定时任务

1. 服务端有新的任务触发，需要执行任务时，会调用客户端固定地址(http://ip:port/job-instance/submit) 执行任务，客户端需要实现执行任务逻辑。
2. 客户端在任务执行过程中，调用上报任务日志接口，批量上报任务运行日志。
3. 客户端任务执行完成时，调用服务端接口批量上报任务状态。
4. 服务端收到任务终止命名时，会触发客户端终止任务，调用客户端固定地址(http://ip:port/job-instance/stop)，客户端需要实现任务终止逻辑。
5. 服务端特殊场景下，主动检查任务实例是否正常运行，调用客户端固定地址(http://ip:port/job-instance/check)，客户端需要实现任务检查逻辑。